SET DEFINE OFF;
CREATE OR REPLACE FUNCTION fn_get_feeamt_vatincl(PV_FEEAMT IN VARCHAR2, PV_VATRATE IN VARCHAR2, PV_CCYCD IN VARCHAR2)
RETURN NUMBER
IS --NAM.LY 27/04/2020
  V_FEEAMT  NUMBER;
  V_VATRATE NUMBER;
  V_RESULT  NUMBER;
BEGIN
    V_FEEAMT  := TO_NUMBER(PV_FEEAMT);
    V_VATRATE := TO_NUMBER(PV_VATRATE);
    --
    IF (V_VATRATE > 0) THEN
        V_RESULT := V_FEEAMT + V_FEEAMT * V_VATRATE / 100;
    ELSE
        V_RESULT := V_FEEAMT;
    END IF;
    --
    IF (PV_CCYCD = 'USD') THEN
       V_RESULT := ROUND(V_RESULT,2);
    ELSIF (PV_CCYCD = 'VND') THEN
       V_RESULT := ROUND(V_RESULT,0);
    END IF;
    RETURN V_RESULT;
    EXCEPTION WHEN OTHERS THEN RETURN 0;
END;
/

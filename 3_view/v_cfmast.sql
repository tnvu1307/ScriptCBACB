SET DEFINE OFF;
CREATE OR REPLACE FORCE VIEW V_CFMAST
(CUSTID, CUSTODYCD, SHORTNAME, FULLNAME, MNEMONIC, 
 DATEOFBIRTH, IDTYPE, IDCODE, IDDATE, IDPLACE, 
 IDEXPIRED, ADDRESS, MOBILE, PHONE, FAX, 
 EMAIL, COUNTRY, PROVINCE, POSTCODE, RESIDENT, 
 CLASS, GRINVESTOR, INVESTRANGE, TIMETOJOIN, STAFF, 
 COMPANYID, ISSUERID, POSITION, SEX, SECTOR, 
 FOCUSTYPE, BUSINESSTYPE, INVESTTYPE, EXPERIENCETYPE, INCOMERANGE, 
 ASSETRANGE, BRID, CAREBY, APPROVEID, LASTDATE, 
 AUDITORID, AUDITDATE, LANGUAGE, BANKACCTNO, BANKCODE, 
 MARRIED, DESCRIPTION, STATUS)
AS 
SELECT SUBSTR(CUSTID,1,4) || '.' || SUBSTR(CUSTID,5,6) CUSTID, SUBSTR(CUSTODYCD,1,3) || '.' || SUBSTR(CUSTODYCD,4,1) || '.' || SUBSTR(CUSTODYCD,5,6) CUSTODYCD,

SHORTNAME,FULLNAME,MNEMONIC,DATEOFBIRTH,A1.CDCONTENT IDTYPE,IDCODE,IDDATE,IDPLACE,IDEXPIRED,ADDRESS,MOBILE,PHONE,FAX,EMAIL,

A2.CDCONTENT COUNTRY,A3.CDCONTENT PROVINCE,POSTCODE,A4.CDCONTENT RESIDENT,A5.CDCONTENT CLASS,A6.CDCONTENT GRINVESTOR,

A7.CDCONTENT INVESTRANGE,A8.CDCONTENT TIMETOJOIN,A9.CDCONTENT STAFF,COMPANYID,ISSUERID,A10.CDCONTENT POSITION,A11.CDCONTENT SEX,

A12.CDCONTENT SECTOR,A13.CDCONTENT FOCUSTYPE,A14.CDCONTENT BUSINESSTYPE,A15.CDCONTENT INVESTTYPE,A16.CDCONTENT EXPERIENCETYPE,

A17.CDCONTENT INCOMERANGE,A18.CDCONTENT ASSETRANGE,BRID,CAREBY,APPROVEID,LASTDATE,AUDITORID,AUDITDATE,A19.CDCONTENT LANGUAGE,BANKACCTNO,A20.CDCONTENT BANKCODE,A21.CDCONTENT MARRIED,DESCRIPTION,A22.CDCONTENT STATUS
FROM
CFMAST,ALLCODE A1, ALLCODE A2,ALLCODE A3,ALLCODE A4,ALLCODE A5,ALLCODE A6,ALLCODE A7,ALLCODE A8,ALLCODE A9,ALLCODE A10, ALLCODE A11,ALLCODE A12,ALLCODE A13,ALLCODE A14,ALLCODE A15,ALLCODE A16,ALLCODE A17, ALLCODE A18,ALLCODE A19,ALLCODE A20,ALLCODE A21,ALLCODE A22
WHERE
A1.CDTYPE = 'CF' AND A1.CDNAME = 'IDTYPE' AND A1.CDVAL= IDTYPE AND A2.CDTYPE = 'CF' AND A2.CDNAME = 'COUNTRY' AND A2.CDVAL= COUNTRY AND A3.CDTYPE = 'CF' AND A3.CDNAME = 'PROVINCE' AND A3.CDVAL= PROVINCE AND A4.CDTYPE = 'CF' AND A4.CDNAME = 'RESIDENT' AND A4.CDVAL= RESIDENT AND A5.CDTYPE = 'CF' AND A5.CDNAME = 'CLASS' AND A5.CDVAL= CLASS AND A6.CDTYPE = 'CF' AND A6.CDNAME = 'GRINVESTOR' AND A6.CDVAL= GRINVESTOR AND A7.CDTYPE = 'CF' AND A7.CDNAME = 'INVESTRANGE' AND A7.CDVAL= INVESTRANGE AND A8.CDTYPE = 'CF' AND A8.CDNAME = 'TIMETOJOIN' AND A8.CDVAL= TIMETOJOIN AND A9.CDTYPE = 'CF' AND A9.CDNAME = 'STAFF' AND A9.CDVAL= STAFF AND A10.CDTYPE = 'CF' AND A10.CDNAME = 'POSITION' AND A10.CDVAL= POSITION AND A11.CDTYPE = 'CF' AND A11.CDNAME = 'SEX' AND A11.CDVAL= SEX AND A12.CDTYPE = 'CF' AND A12.CDNAME = 'SECTOR' AND A12.CDVAL= SECTOR AND A13.CDTYPE = 'CF' AND A13.CDNAME = 'FOCUSTYPE' AND A13.CDVAL= FOCUSTYPE AND A14.CDTYPE = 'CF' AND A14.CDNAME = 'BUSINESSTYPE' AND A14.CDVAL= BUSINESSTYPE AND A15.CDTYPE = 'CF' AND A15.CDNAME = 'INVESTTYPE' AND A15.CDVAL= INVESTTYPE AND A16.CDTYPE = 'CF' AND A16.CDNAME = 'EXPERIENCETYPE' AND A16.CDVAL= EXPERIENCETYPE AND A17.CDTYPE = 'CF' AND A17.CDNAME = 'INCOMERANGE' AND A17.CDVAL= INCOMERANGE AND A18.CDTYPE = 'CF' AND A18.CDNAME = 'ASSETRANGE' AND A18.CDVAL= ASSETRANGE AND A19.CDTYPE = 'CF' AND A19.CDNAME = 'LANGUAGE' AND A19.CDVAL= LANGUAGE AND A20.CDTYPE = 'CF' AND A20.CDNAME = 'BANKCODE' AND A20.CDVAL= BANKCODE
AND A21.CDTYPE = 'CF' AND A21.CDNAME = 'MARRIED' AND A21.CDVAL= MARRIED
AND A22.CDTYPE = 'CF' AND A22.CDNAME = 'CFSTATUS' AND A22.CDVAL= STATUS
/

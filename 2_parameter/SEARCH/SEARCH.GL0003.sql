SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('GL0003','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('GL0003', 'Ðiều chỉnh GL', 'Adjust GL', 'SELECT *
FROM(
    SELECT P1.CREBITACCOUNT, P1.DEBITACCOUNT, P1.CFTYPE, P1.TRADEPLACE, P1.CCYCD, A1.CDCONTENT CCFTYPE, A2.CDCONTENT CTRADEPLACE, SB.SHORTCD CCCYCD,
        SUM(CASE WHEN ER.DEBITACCT = P1.DEBITACCOUNT THEN AMOUNT 
                 WHEN ER.DEBITACCT = P1.CREBITACCOUNT THEN -AMOUNT
                 ELSE 0
             END) TOTAL
    FROM (
        SELECT * FROM POSTMAPEXT WHERE DORC = ''C''
    ) P1,
    (
        SELECT * FROM POSTMAPEXT WHERE DORC = ''D''
    ) P2,
    (SELECT * FROM SBCURRENCY) SB,
    (SELECT * FROM GL_EXP_RESULTS) ER,
    (SELECT * FROM ALLCODE WHERE CDNAME = ''CUSTYPE'' AND CDTYPE = ''GL'') A1,
    (SELECT * FROM ALLCODE WHERE CDNAME = ''TRADEPLACE'' AND CDTYPE = ''GL'') A2
    WHERE P1.CFTYPE = P2.CFTYPE
    AND P1.CCYCD = P2.CCYCD
    AND P1.TRADEPLACE = P2.TRADEPLACE
    AND P1.CREBITACCOUNT = P2.DEBITACCOUNT
    AND P1.CFTYPE = A1.CDVAL(+)
    AND P1.TRADEPLACE = A2.CDVAL(+)
    AND P1.CCYCD = SB.CCYCD(+)
    AND (P1.CREBITACCOUNT = ER.DEBITACCT OR P1.CREBITACCOUNT = ER.CREDITACCT)
    GROUP BY P1.CREBITACCOUNT, P1.DEBITACCOUNT, P1.CFTYPE, P1.TRADEPLACE, P1.CCYCD, A1.CDCONTENT, A2.CDCONTENT, SB.SHORTCD
) WHERE 0=0', 'GL0003', 'frmGL0003', '', '9903', 0, 5000, 'N', 1, 'NYNNYYYNNN', 'Y', 'T', '', 'N', '');COMMIT;
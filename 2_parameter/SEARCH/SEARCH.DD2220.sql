SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('DD2220','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('DD2220', 'Chi tiết phát sinh tiền', 'Details generate money', 'SELECT * FROM (
    SELECT LOG.BUSDATE, REPLACE(NVL(NVL(TL1.txdesc ,LOG.TXDESC),TLTX.<@CDCONTENT>), ''BLACKLIST - '', '''') TXDESC, TL1.TLTXCD TLTXCD,
           (CASE WHEN LOG.TXTYPE = ''C'' THEN LOG.NAMT ELSE 0 END) CREDIT,
           (CASE WHEN LOG.TXTYPE = ''D'' THEN LOG.NAMT ELSE 0 END) DEBIT,
           CF.CUSTODYCD, CF.CIFID, DD.ACCTNO, DD.REFCASAACCT, DD.CCYCD, CF.FULLNAME, TL1.OFFTIME,
           TLTX.<@CDCONTENT> BUSINESS
    FROM DDMAST DD, VW_DDTRAN_GEN LOG, AFMAST AF, CFMAST CF, VW_TLLOG_ALL TL1,
    (SELECT EN_TXDESC, TLTXCD, TXDESC CDCONTENT, EN_TXDESC EN_CDCONTENT FROM TLTX) TLTX
    WHERE DD.ACCTNO = LOG.ACCTNO
    AND AF.ACCTNO = DD.AFACCTNO
    AND AF.CUSTID = CF.CUSTID
    AND LOG.TLTXCD = TLTX.TLTXCD
    AND LOG.TXDATE = TL1.TXDATE AND LOG.TXNUM = TL1.TXNUM
    AND LOG.FIELD = ''BALANCE''
    AND LOG.TLTXCD NOT IN (''6690'', ''6691'', ''6696'', ''6697'', ''6698'', ''6699'', ''6689'', ''6692'', ''6603'', ''6604'')
    AND LOG.TLTXCD NOT IN (''6628'', ''6629'', ''6615'', ''6659'')
    AND TL1.TLTXCD NOT IN (''1296'')
    AND NOT EXISTS (
        SELECT 1 FROM VW_TLLOG_ALL TL2
        WHERE TL2.TLTXCD IN (''6628'', ''6629'', ''6615'', ''6659'')
        AND TL2.TXDATE = TL1.TXDATE
        AND TL2.REFTXNUM = TL1.TXNUM
    )
)
WHERE 0=0', 'DDTRANGEN', 'frmDDTRANGEN', 'BUSDATE desc,CUSTODYCD desc', '', 0, 5000, 'N', 1, 'NNNNYYYNNN', 'Y', 'T', '', 'N', '');COMMIT;
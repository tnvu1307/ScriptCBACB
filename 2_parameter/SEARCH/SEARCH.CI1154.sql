SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('CI1154','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('CI1154', 'Hủy GD ứng trước lệnh bán theo ngày (1154)', 'View available order for cancel advance payment (1154)', 'SELECT case SUBSTR(txnum,1,2)
       when  ''68'' then ''OL''
       when  ''69'' then ''HO''
       when  ''70'' then ''MB''
       else  ''BO'' end VIA
,txtime,LOCATION, TXNUM, TXDATE, CUSTODYCD, FULLNAME, ADDRESS, IDCODE, IDDATE, IDPLACE, ACCTNO, NAMT, FEE,(NAMT-FEE) RECEIVE, TRDESC, TXDESC, CUSTID
FROM (
    SELECT FN_GET_LOCATION(SUBSTR(ACCTNO,1,4)) LOCATION,ci.txtime, CI.TXNUM, CI.TXDATE, CF.CUSTID, CF.CUSTODYCD, CF.FULLNAME, CF.ADDRESS, CF.IDCODE, CF.IDDATE, CF.IDPLACE, CI.ACCTNO, NAMT, FEE, TRDESC, TXDESC
    FROM (
        SELECT * FROM VW_CITRAN_GEN CI WHERE TLTXCD=''1153'' AND TXDATE= GETCURRDATE() AND FIELD=''BALANCE'' AND TXTYPE=''C'' and SUBSTR(txnum,1,2) <> ''99''
    ) CI LEFT JOIN
        (SELECT custid, txnum, namt fee FROM VW_CITRAN_GEN CI WHERE TLTXCD=''1153'' AND TXDATE= GETCURRDATE() AND FIELD=''BALANCE'' AND TXTYPE=''D'') FEE on ci.txnum = fee.txnum
        , CFMAST CF
    WHERE CF.CUSTID=CI.CUSTID
) WHERE 0=0', 'CIMAST', '', '', '1154', NULL, 5000, 'N', 1, 'NYNNYYYNNN', 'Y', 'T', '', 'N', '');COMMIT;
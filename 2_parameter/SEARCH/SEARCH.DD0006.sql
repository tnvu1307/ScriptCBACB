SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('DD0006','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('DD0006', 'Đẩy dữ liệu Fee hàng tháng', 'Track Export Fee data monthly', 'SELECT * FROM (
    SELECT FEE.AUTOID,CF.FULLNAME,CF.CUSTODYCD,BANKACCOUNT BANKACCTNO,FEE.CIFID PROFOLIOCD,CURRENCY CCYCD ,FEE.FEEAMOUNT,1 FXRATE,FEE.FEEAMOUNT FXAMOUNT,NVL(FEE.TAXAMOUNT,0) TAXAMOUNT,
    DECODE(FEE.CURRENCY,''VND'',ROUND((NVL(FEE.FEEAMOUNT,0) + NVL(FEE.TAXAMOUNT,0)),0),ROUND((NVL(FEE.FEEAMOUNT,0) + NVL(FEE.TAXAMOUNT,0)),2)) FEEAMTVAT,
    AL.<@CDCONTENT> STATUS,FEE.FEECODE,SETTLEDATE PAIDDATE ,FEE.REMARK,FEE.TXDATE,FEE.TRANSDATE,FEE.SETTLEDATE,AL2.EN_DISPLAY FEENAME, FEE.FEENAME  FEENAMECSTD, FEE.MCIFID, CF.MCUSTODYCD,
    AMC.SHORTNAME AMCSHORTNAME, GCB.SHORTNAME GCBSHORTNAME
    FROM FEE_BOOKING_RESULT FEE,
    (
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''SEDEPO'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''SEDEPO'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''OTHER'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''OTHER'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''TRANREPAIR'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''TRANREPAIR'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''PROXY'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''PROXY'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''STC'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''STC'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''BONDOTHER'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''BONDOTHER'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''SETRAN'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''SETRAN'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''ASSETMNG'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''ASSETMNG'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''BONDMNG'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''BONDMNG'' AND A2.CDTYPE = ''SA''
        UNION ALL
        SELECT  A2.CDVAL FILTERCD,A2.CDVAL VALUE, A2.CDVAL VALUECD, A2.CDCONTENT DISPLAY, A2.EN_CDCONTENT EN_DISPLAY, ''PAYAGENCY'' ID FROM  ALLCODE A2
        WHERE A2.CDNAME = ''PAYAGENCY'' AND A2.CDTYPE = ''SA''
    ) AL2,
    (
        SELECT * FROM ALLCODE WHERE CDNAME = ''FSTATUS'' AND CDTYPE = ''DD''
    ) AL,
    (
        SELECT * FROM CFMAST WHERE SUPEBANK = ''N''
    ) CF,
    (SELECT * FROM FAMEMBERS WHERE ROLES = ''AMC'') AMC,
    (SELECT * FROM FAMEMBERS WHERE ROLES = ''GCB'') GCB
    WHERE FEE.STATUS = ''P'' AND FEE.DELTD = ''N''
    and FEE.STATUS = AL.CDVAL(+)
    AND FEE.SUBTYPE = AL2.VALUE(+)
    AND FEE.REFCODE = AL2.ID(+)   
    AND CF.CIFID = FEE.CIFID
    AND CF.STATUS NOT IN (''C'')
    AND CF.AMCID = AMC.AUTOID(+)
    AND CF.GCBID =GCB.AUTOID(+)
) WHERE 0=0', 'FEEBOOK', 'frmFEEBOOK', NULL, '1297/1298/1299', 0, 5000, 'N', 1, 'NNNNYNYNNNN', 'Y', 'T', NULL, 'N', NULL);COMMIT;
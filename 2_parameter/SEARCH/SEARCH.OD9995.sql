SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('OD9995','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('OD9995', 'Hiển thị các lệnh nhóm', 'Show group order', '
SELECT ORDGRPID, REPLACE(ORDERID || TO_CHAR(SEQ_ODMAST.NEXTVAL,''000000''),'' '','''') ORDERID,
    DECODE(TYPE,''S'',''CK giao dịch'', ''D'', ''CK cầm cố'', ''O'', ''CK giao dịch CHƯA KHỚP'', ''M'', ''CK cầm cố CHƯA KHỚP'') TYPE , REFACCTNO,
    CODEID, SYMBOL, ACTYPE, QUOTEPRICE, ORDERQTTY,
    AFACCTNO, AFACCTNO||A.CODEID SEACCTNO, CLEARDAY, BRATIO, LIMITPRICE, PARVALUE, EFFDATE, TIMETYPE, EXPDATE, CASE WHEN TYPE IN (''M'',''D'') THEN ''MS'' ELSE ''NS'' END EXECTYPE, NORK, MATCHTYPE, VIA, CLEARCD, PRICETYPE, VOUCHER,
    CONSULTANT, DESCRIPTION, CONTRAFIRM, TRADERID, CLIENTID, OUTPRICEALLOW, ADVIDREF, FEEAMT, CUSTID CUSTNAME, GRPORDER, CASE WHEN TYPE IN (''M'',''D'') THEN 1 ELSE 0 END ISMORTAGE, CONTRACUS,
    PUTTYPE, CONTRAFIRMA, SSAFACCTNO, DEALID, TRADEUNITGTC, MODEA, TRADEUNIT, HUNDRED  FROM (
    SELECT B.ORDERID ORDGRPID, REPLACE(SUBSTR(B.ORDERID,1,4) ||SUBSTR(REPLACE(TO_CHAR(A.TXDATE,''DD/MM/RRRR''),''/'',''''),1,4) ||
    SUBSTR(REPLACE(TO_CHAR(A.TXDATE,''DD/MM/RRRR''),''/'',''''),7,2) ,'' '','''')    ORDERID, B.TYPE,
    A.CODEID,C.SYMBOL , A.ACTYPE,A.QUOTEPRICE/F.TRADEUNIT QUOTEPRICE,  B.QTTY ORDERQTTY,
    DECODE(B.TYPE,''S'',SUBSTR(B.REFID,1,10),''D'',(SELECT AFACCTNO FROM DFMAST WHERE ACCTNO=B.REFID),''O'',(SELECT AFACCTNO FROM ODMAST WHERE
    ORDERID=B.REFID),''M'',(SELECT AFACCTNO FROM DFMAST WHERE ACCTNO=B.REFID)) AFACCTNO, AFACCTNO||A.CODEID SEACCTNO, A.CLEARDAY,  ROUND(A.BRATIO,2) BRATIO, A.LIMITPRICE, C.PARVALUE,
    A.EXPDATE EFFDATE, A.TIMETYPE, A.EXPDATE, A.EXECTYPE, A.NORK, ''P'' MATCHTYPE, A.VIA, A.CLEARCD, A.PRICETYPE,B.ORDERID VOUCHER,
    ''I'' CONSULTANT,     A.AFACCTNO ||''.''||E.FULLNAME||''.''||A.MATCHTYPE||A.EXECTYPE||''.''||B.QTTY||''.''|| A.QUOTEPRICE/F.TRADEUNIT DESCRIPTION,
    CONTRAFIRM, TRADERID, CLIENTID,     ''N'' OUTPRICEALLOW, '''' ADVIDREF, 0 FEEAMT, E.FULLNAME CUSTNAME,     ''N'' GRPORDER, 0 ISMORTAGE,
    A.CONTRAFIRM CONTRACUS, ''3'' PUTTYPE, ''A'' CONTRAFIRMA, B.REFID SSAFACCTNO,
    CASE WHEN B.TYPE = ''O'' THEN A.SEACCTNO ELSE B.REFID END REFACCTNO,
    DECODE(B.TYPE,''S'','''',''D'',B.REFID,''O'','''',''M'',B.REFID) DEALID,
    1 TRADEUNITGTC, ''A'' MODEA, F.TRADEUNIT, 100 HUNDRED,e.CUSTID FROM ODMAST A,
    (SELECT * FROM ODMAPEXT WHERE DELTD <> ''Y'' AND STATUS <> ''Y'' ORDER BY ORDERID) B, SBSECURITIES C, AFMAST D, CFMAST E , SECURITIES_INFO F
    WHERE A.ORDERID = B.ORDERID AND A.CODEID=C.CODEID AND D.ACCTNO=A.AFACCTNO AND D.CUSTID=E.CUSTID AND A.CODEID=F.CODEID
    AND A.exectype =''NS'' and A.matchtype=''P'' and A.grporder=''Y''
    and A.deltd<>''Y'' ) A WHERE 0=0  ', 'OD.ODMAST', 'frmGROUPORDERPT', NULL, '8877', NULL, 5000, 'N', 1, 'NYNNYYYNNN', 'Y', 'T', NULL, 'N', NULL);COMMIT;
SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('DF2690','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('DF2690', 'Chuyển nợ SIC thành nợ Write-off (2690)', 'Transfer SIC debt to Write-off debt (2690)', 'SELECT CF.CUSTODYCD, CF.CUSTID, DF.AFACCTNO, CF.FULLNAME, DFT.ACTYPE, DFT.TYPENAME, DF.GROUPID, DF.LNACCTNO, LNS.AUTOID LNSCHDID,
    DF.DESCRIPTION, LNS.RLSDATE, LNS.DUEDATE,
    ROUND(CASE WHEN LNS.OVERDUEDATE > TO_DATE(SY.VARVALUE,''DD/MM/RRRR'') THEN LNS.NML ELSE 0 END) PRINNML,
    ROUND(CASE WHEN LNS.OVERDUEDATE > TO_DATE(SY.VARVALUE,''DD/MM/RRRR'') THEN LNS.NML ELSE 0 END) PPRINNML,
    ROUND(CASE WHEN LNS.OVERDUEDATE = TO_DATE(SY.VARVALUE,''DD/MM/RRRR'') THEN LNS.NML ELSE 0 END) PRINDUE,
    ROUND(CASE WHEN LNS.OVERDUEDATE = TO_DATE(SY.VARVALUE,''DD/MM/RRRR'') THEN LNS.NML ELSE 0 END) PPRINDUE,
    LNS.OVD PRINOVD, LNS.OVD PPRINOVD, ROUND(LNS.INTNMLACR) INTNMLACR, ROUND(LNS.INTNMLACR) PINTNMLACR,
    ROUND(LNS.INTDUE) INTDUE, ROUND(LNS.INTDUE) PINTDUE, ROUND(LNS.INTOVD) INTOVD, ROUND(LNS.INTOVD) PINTOVD, ROUND(LNS.INTOVDPRIN) INTOVDPRIN, ROUND(LNS.INTOVDPRIN) PINTOVDPRIN,
    ROUND(LNS.FEEINTNMLACR) FEEINTNMLACR, ROUND(LNS.FEEINTNMLACR) PFEEINTNMLACR, ROUND(LNS.FEEINTDUE) FEEINTDUE, ROUND(LNS.FEEINTDUE) PFEEINTDUE, ROUND(LNS.FEEINTNMLOVD) FEEINTNMLOVD,
    ROUND(LNS.FEEINTNMLOVD) PFEEINTNMLOVD, ROUND(LNS.FEEINTOVDACR) FEEINTOVDACR, ROUND(LNS.FEEINTOVDACR) PFEEINTOVDACR,
    LNS.NML + LNS.OVD + ROUND(LNS.INTNMLACR) + ROUND(LNS.INTDUE) + ROUND(LNS.INTOVD) + ROUND(LNS.INTOVDPRIN)
    + ROUND(LNS.FEEINTNMLACR) + ROUND(LNS.FEEINTDUE) + ROUND(LNS.FEEINTNMLOVD) + ROUND(LNS.FEEINTOVDACR) TOTALLOAN,
    LNS.NML + LNS.OVD + ROUND(LNS.INTNMLACR) + ROUND(LNS.INTDUE) + ROUND(LNS.INTOVD) + ROUND(LNS.INTOVDPRIN)
    + ROUND(LNS.FEEINTNMLACR) + ROUND(LNS.FEEINTDUE) + ROUND(LNS.FEEINTNMLOVD) + ROUND(LNS.FEEINTOVDACR) PTOTALLOAN,
    LNS.PAID + ROUND(LNS.INTPAID) + ROUND(LNS.FEEPAID) + ROUND(LNS.FEEPAID2) + ROUND(LNS.FEEINTPREPAID) + ROUND(LNS.FEEINTPAID) + ROUND(LNS.PAIDFEEINT) PAID
FROM DFMAST DF, AFMAST AF, CFMAST CF, DFTYPE DFT, LNSCHD LNS, LNMAST LN, SYSVAR SY
WHERE DF.AFACCTNO = AF.ACCTNO
    AND AF.CUSTID = CF.CUSTID
    AND DF.ACTYPE = DFT.ACTYPE
    AND DF.LNACCTNO = LNS.ACCTNO
    AND DF.LNACCTNO = LN.ACCTNO
    AND LN.ACTYPE IN (''0040'')
    AND LNS.REFTYPE = ''P''
    AND SY.GRNAME = ''SYSTEM'' AND SY.VARNAME = ''CURRDATE''
    AND LNS.NML+LNS.OVD+LNS.INTNMLACR+LNS.INTDUE+LNS.INTOVD+LNS.INTOVDPRIN+LNS.FEEINTNMLACR+LNS.FEEINTDUE+LNS.FEEINTNMLOVD+LNS.FEEINTOVDACR>1', 'DFGROUP', '', ' CUSTODYCD, AFACCTNO, GROUPID, LNSCHDID ', '2690', NULL, 5000, 'N', 1, 'NYNNYYYNNN', 'Y', 'T', '', 'N', '');COMMIT;
SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('CFAFTRDLNK','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('CFAFTRDLNK', 'Tài khoản đầu tư', 'Trader account', 'SELECT MST.AUTOID, MST.AFACCTNO, TL.TLNAME, GRP.GRPNAME, MST.LASTDATE, MST.ADMINID, MST.LEADERID, 
AD.TLNAME ADMIN, LD.TLNAME LEADER, A0.CDCONTENT STATUS,(CASE WHEN MST.STATUS IN (''P'') THEN ''Y'' ELSE ''N'' END) APRALLOW, rf.MKNAME, RF.CKNAME
FROM CFAFTRDLNK MST, TLPROFILES TL, TLGROUPS GRP, TLPROFILES AD, TLPROFILES LD, ALLCODE A0,
	(SELECT distinct A.AUTOID, B.MAKER_ID, B.MAKER_DT, B.APPROVE_ID, B.APPROVE_DT, MK.TLNAME MKNAME, CK.TLNAME CKNAME
  FROM
  (SELECT M.AUTOID, ''CFAFTRDLNK'' TBLID, ''AUTOID = '''''' || M.AUTOID || '''''''' RCRID, MAX(L.MOD_NUM) LSTID
  FROM CFAFTRDLNK M, maintain_log L
  where L.table_name=''CFAFTRDLNK'' AND L.RECORD_KEY=''AUTOID = '''''' || M.AUTOID || '''''''' GROUP BY M.AUTOID) A, 
    maintain_log B, TLPROFILES MK, TLPROFILES CK 
  WHERE A.TBLID=B.table_name AND A.RCRID=B.RECORD_KEY AND A.LSTID=B.MOD_NUM
  AND B.MAKER_ID = MK.TLID  AND B.APPROVE_ID = CK.TLID (+)) RF
  WHERE TL.TLID=MST.TRADERID AND MST.GROUPID=GRP.GRPID AND GRP.GRPTYPE=''3''  AND MST.AUTOID = RF.AUTOID (+)
  AND AD.TLID=MST.ADMINID AND LD.TLID=MST.LEADERID
  AND A0.CDTYPE=''SY'' AND A0.CDNAME=''TYPESTS'' AND A0.CDVAL=MST.STATUS', 'CFAFTRDLNK', 'frmCFAFTRDLNK', '', '', NULL, 5000, 'N', 1, '', 'Y', 'T', '', 'N', '');COMMIT;
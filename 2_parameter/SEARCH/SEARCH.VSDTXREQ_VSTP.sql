SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('VSDTXREQ_VSTP','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('VSDTXREQ_VSTP', 'Tra cứu thông tin chi tiết trạng thái điện gửi VSD (VSTP)', 'Manage the details of messages sent VSD (VSTP)', 'SELECT REQ.REQID REQID, REQ.OBJNAME, SUBSTR(REQ.TRFCODE,1,3)TRFCODE, REQ.OBJKEY, REQ.TLID, TO_DATE(REQ.TXDATE,''DD/MM/RRRR'')TXDATE,
    CASE WHEN REQ.MSGACCT IN (SELECT CUSTODYCD FROM CFMAST WHERE CUSTODYCD = REQ.MSGACCT) THEN REQ.MSGACCT
         ELSE
            CASE WHEN REQ.AFACCTNO IN (SELECT ACCTNO FROM AFMAST WHERE ACCTNO = REQ.AFACCTNO)
                THEN (SELECT CF.CUSTODYCD FROM CFMAST CF,AFMAST AF WHERE CF.CUSTID = AF.CUSTID AND AF.ACCTNO = REQ.AFACCTNO)
                 WHEN REQ.MSGACCT IN (SELECT CF.CUSTID FROM CFMAST CF WHERE CF.CUSTID = REQ.MSGACCT)
                THEN (SELECT CF.CUSTODYCD FROM CFMAST CF WHERE CF.CUSTID = REQ.MSGACCT)
            ELSE REQ.MSGACCT END
    END MSGACCT,
    DECODE(TRF.TYPE, ''INF'', TRF.DESCRIPTION, CODE.CDCONTENT || (CASE WHEN REQ.OBJNAME IN (''9999'') THEN '' - '' || REQD.OCVAL ELSE '''' END)) NOTES,
    REQ.AFACCTNO, REQ.VSD_ERR_MSG || '' '' || REQ.BOPROCESS_ERR VSD_ERR_MSG,
    TO_CHAR(REQ.CREATEDATE,''HH24:MI:SS'') CREATEDATE,
    A5.<@CDCONTENT> MSGSTATUS, A5.CDVAL
FROM VSDTXREQ_VSTP REQ,
(SELECT TRFCODE, DESCRIPTION CDCONTENT, EN_DESCRIPTION EN_CDCONTENT, TLTXCD FROM VSDTRFCODE_VSTP) CODE,
(SELECT * FROM VSDTXREQDTL_VSTP WHERE FLDNAME in (''REPORTID'',''RPTID''))REQD,
(
    SELECT DESCRIPTION, TRFCODE, TYPE, DECODE(TYPE,''INF'',TYPE,TLTXCD) OBJNAME
    FROM VSDTRFCODE
) TRF,
(SELECT * FROM ALLCODE WHERE CDTYPE = ''SA'' AND CDNAME = ''VSDTXREQSTS'') A5
WHERE REQ.TRFCODE = CODE.TRFCODE
AND REQ.OBJNAME = CODE.TLTXCD
AND REQ.MSGSTATUS = A5.CDVAL(+)
AND REQ.REQID = REQD.REQID(+)
AND REQ.TRFCODE = TRF.TRFCODE(+)
AND NVL(REQ.OBJNAME,''INF'') = TRF.OBJNAME (+)', 'VSDTXREQ_VSTP', 'frmVSDTXREQ_VSTP', 'TXDATE DESC,REQID DESC', NULL, NULL, 5000, 'Y', 1, NULL, 'Y', 'T', NULL, 'N', NULL);COMMIT;
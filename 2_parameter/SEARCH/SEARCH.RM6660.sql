SET DEFINE OFF;DELETE FROM SEARCH WHERE 1 = 1 AND NVL(SEARCHCODE,'NULL') = NVL('RM6660','NULL');Insert into SEARCH   (SEARCHCODE, SEARCHTITLE, EN_SEARCHTITLE, SEARCHCMDSQL, OBJNAME, FRMNAME, ORDERBYCMDSQL, TLTXCD, CNTRECORD, ROWPERPAGE, AUTOSEARCH, INTERVAL, AUTHCODE, ROWLIMIT, CMDTYPE, CONDDEFFLD, BANKINQ, BANKACCT) Values   ('RM6660', 'Tra cứu yên cầu HOLD chờ xác nhận (6660)', 'View pending HOLD to confirm  (6660)', 'SELECT REQ.REQID,REQ.TRFCODE,REQ.OBJKEY TXNUM,REQ.OBJNAME TLTX,REQ.TXDATE,REQ.BANKCODE,CF.CUSTODYCD,REQ.AFACCTNO,
CF.FULLNAME,CF.ADDRESS,CF.IDCODE LICENSE,REQ.BANKACCT BANKACCTNO,CRB.BANKCODE || '':'' || CRB.BANKNAME BANKNAME,
REQ.TXAMT,REQ.STATUS,CI.HOLDBALANCE
FROM CRBTXREQ REQ,AFMAST AF,CFMAST CF,CIMAST CI,CRBDEFBANK CRB
WHERE REQ.AFACCTNO=AF.ACCTNO AND AF.CUSTID=CF.CUSTID
AND AF.ACCTNO=CI.AFACCTNO AND CI.COREBANK=''Y'' AND REQ.BANKCODE=CRB.BANKCODE
AND REQ.TRFCODE IN (''HOLD'') AND REQ.STATUS=''P'' --AND REQ.REQID=p_reqid
AND NOT EXISTS (
   SELECT * FROM TLLOGFLD FLD,TLLOG TL
   WHERE FLD.TXNUM=TL.TXNUM AND FLD.FLDCD=''22''
   AND TL.TLTXCD=''6660'' AND FLD.CVALUE = TO_CHAR(REQ.REQID)
)
AND EXISTS (
    SELECT * FROM CRBTXREQLOG LG
    WHERE REQ.REFCODE=LG.refcode AND REQ.BANKCODE=LG.BANKCODE
    AND REQ.TRFCODE=LG.trfcode AND REQ.TXDATE=LG.txdate AND LG.STATUS=''C''
)', 'BANKINFO', NULL, NULL, '6660', NULL, 5000, 'N', 1, NULL, 'Y', 'T', NULL, 'N', NULL);COMMIT;
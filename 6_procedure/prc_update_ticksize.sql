SET DEFINE OFF;
CREATE OR REPLACE PROCEDURE prc_update_ticksize (
                CODEID IN VARCHAR2,
                SYMBOL IN VARCHAR2,
                TRADEPLACE IN VARCHAR2,
                SECTYPE   IN VARCHAR2,
                PARVALUE  IN NUMBER,
                INTRATE   IN NUMBER,
                STATUS    IN VARCHAR2,
                CAREBY    IN VARCHAR2,
                EXPDATE   IN VARCHAR2,
                DEPOSITORY   IN VARCHAR2,
                CHKRATE      IN NUMBER,
                INTPERIOD    IN NUMBER,
                ISSUEDATE    IN VARCHAR2,
                ISSUERID     IN VARCHAR2,
                FOREIGNRATE  IN NUMBER,
                MANAGEMENTTYPE IN VARCHAR2
       )
IS
          V_CODEID           VARCHAR2(10);
          V_SYMBOL           VARCHAR2(80);
          V_TRADEPLACE       VARCHAR2(3);

           V_SECTYPE  VARCHAR2(10);
           V_PARVALUE  NUMBER;
           V_INTRATE    VARCHAR2(10);
           V_STATUS     VARCHAR2(1);
           V_CAREBY     VARCHAR2(10);
           V_EXPDATE    DATE;
           V_DEPOSITORY    VARCHAR2(10);
           V_CHKRATE       VARCHAR2(10);
           V_INTPERIOD     VARCHAR2(10);
           V_ISSUEDATE     DATE;
           V_ISSUERID      VARCHAR2(10);
           V_FOREIGNRATE   VARCHAR2(10);
           V_MANAGEMENTTYPE  VARCHAR2(10);

          V_TRADENAME        VARCHAR2(10);
          v_strCURRDATE      DATE;
          v_AUTOIDSR         NUMBER;
          v_strWFTcodeid VARCHAR2(10);

BEGIN

          V_CODEID           := CODEID;
          V_SYMBOL           := SYMBOL;
          V_TRADEPLACE       := TRADEPLACE;

           V_SECTYPE  := SECTYPE;
           V_PARVALUE := TO_NUMBER(PARVALUE);
           V_INTRATE:=    INTRATE;
           V_STATUS:=     STATUS;
           V_CAREBY:=    CAREBY;
           V_EXPDATE:=     to_date(EXPDATE,systemnums.C_DATE_FORMAT);
           V_DEPOSITORY:=    DEPOSITORY;
           V_CHKRATE:=      CHKRATE;
           V_INTPERIOD:=     INTPERIOD;
           V_ISSUEDATE:=     to_date(ISSUEDATE,systemnums.C_DATE_FORMAT);
           V_ISSUERID :=     ISSUERID;
           V_FOREIGNRATE:=   FOREIGNRATE;
           V_MANAGEMENTTYPE:= MANAGEMENTTYPE;
          SELECT A.CDCONTENT
          INTO V_TRADENAME
          FROM ALLCODE A
          WHERE        A.CDTYPE = 'SE'
          AND          CDNAME   = 'TRADEPLACE'
          AND          CDVAL    = V_TRADEPLACE;

          SELECT TO_DATE (varvalue, systemnums.c_date_format)
          INTO v_strCURRDATE
          FROM sysvar
          WHERE grname = 'SYSTEM' AND varname = 'CURRDATE';

          SELECT MAX(AUTOID) + 1
          INTO v_AUTOIDSR
          FROM SECURITIES_RATE;

          ---- Delete SECURITIES_TICKSIZE, SECURITIES_INFO, SECURITIES_RATE
          DELETE SECURITIES_TICKSIZE
          WHERE CODEID = V_CODEID;

          DELETE SECURITIES_INFO
          WHERE CODEID = V_CODEID;

          DELETE SECURITIES_RATE
          WHERE CODEID = V_CODEID;
-- XOA CHO CHUNG KHOAN CHO GIAO DICH
          DELETE SBSECURITIES
          WHERE REFCODEID = V_CODEID;
          DELETE SECURITIES_INFO
          WHERE CODEID = (SELECT refcodeid FROM sbsecurities WHERE codeid=V_CODEID);


           IF (V_TRADENAME = 'HOSE') THEN
             if(sectype IN ('001','008')) THEN-- CP thuong, chung chi quy
             ---- INSERT SECURITIES_TICKSIZE (BUOC GIA)
                 INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                 VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 10, 0, 9990, 'Y');

                 INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                 VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 50, 10000, 49950, 'Y');

                 INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                 VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 100, 50000, 100000000, 'Y');
                      ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                 INSERT INTO SECURITIES_INFO (
                        AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY, LISTTINGDATE, REFERENCESTATUS,
                        ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE, OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE,
                        AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE, MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD,
                        DAYRANGE, YEARRANGE, TRADELOT, TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX,
                        REPOLIMITMIN, REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX, SECURERATIOTMIN,
                        SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX, SECUREDRATIOMIN, SECUREDRATIOMAX,
                        CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                 VALUES (
                        SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                        1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                        TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '001',
                        0, 0, 1, 1, 1, 1, 1, 10, 'Y', 0, 1000000000, 0,
                        1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);
             ELSIF  (sectype IN ('011')) THEN -- chung quyen
                     INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                   VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 10, 0, 100000000, 'Y');


                      ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                 INSERT INTO SECURITIES_INFO (
                        AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY, LISTTINGDATE, REFERENCESTATUS,
                        ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE, OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE,
                        AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE, MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD,
                        DAYRANGE, YEARRANGE, TRADELOT, TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX,
                        REPOLIMITMIN, REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX, SECURERATIOTMIN,
                        SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX, SECUREDRATIOMIN, SECUREDRATIOMAX,
                        CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                 VALUES (
                        SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                        1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                        TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '001',
                        0, 0, 1, 1, 1, 1, 1, 10, 'Y', 0, 1000000000, 0,
                        1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);

             ELSIF  (sectype IN ('003','006')) THEN -- trai phieu, trai phieu chuyen doi
                 INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                 VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 1, 0, 100000000, 'Y');

                     ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                 INSERT INTO SECURITIES_INFO (
                        AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY, LISTTINGDATE, REFERENCESTATUS,
                        ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE, OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE,
                        AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE, MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD,
                        DAYRANGE, YEARRANGE, TRADELOT, TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX,
                        REPOLIMITMIN, REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX, SECURERATIOTMIN,
                        SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX, SECUREDRATIOMIN, SECUREDRATIOMAX,
                        CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                 VALUES (
                        SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                        1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                        TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '001',
                        0, 0, 1, 1, 1, 1, 1, 1, 'Y', 0, 1000000000, 0,
                        1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);
             ELSE
                    ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                 INSERT INTO SECURITIES_INFO (
                        AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY, LISTTINGDATE, REFERENCESTATUS,
                        ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE, OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE,
                        AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE, MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD,
                        DAYRANGE, YEARRANGE, TRADELOT, TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX,
                        REPOLIMITMIN, REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX, SECURERATIOTMIN,
                        SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX, SECUREDRATIOMIN, SECUREDRATIOMAX,
                        CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                 VALUES (
                        SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                        1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                        TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '001',
                        0, 0, 1, 1, 1, 1, 1, 0, 'Y', 0, 1000000000, 0,
                        1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);


             END IF;

               ---- INSERT SECURITIES_RATE
             INSERT INTO SECURITIES_RATE (
                    AUTOID, CODEID, SYMBOL, FROMPRICE, TOPRICE, MRRATIORATE, MRRATIOLOAN, STATUS)
             VALUES (
                    v_AUTOIDSR, V_CODEID, V_SYMBOL, 1, 10000000, 100, 100, 'Y');



           ELSIF (V_TRADENAME IN ( 'HNX','UPCOM','OTC') )THEN --NAM.LY 03/03/2020 Them gen ticksize+secinfo cho san OTC
               if(sectype IN ('001','008','011')) THEN-- CP thuong, chung chi quy
                  ---- INSERT SECURITIES_TICKSIZE (BUOC GIA)
                   INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                   VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 100, 0, 10000000, 'Y');

                   ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                   INSERT INTO SECURITIES_INFO (
                          AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY,
                          LISTTINGDATE, REFERENCESTATUS, ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE,
                          OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE, AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE,
                          MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD, DAYRANGE, YEARRANGE, TRADELOT,
                          TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX, REPOLIMITMIN,
                          REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX,
                          SECURERATIOTMIN, SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX,
                          SECUREDRATIOMIN, SECUREDRATIOMAX, CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                   VALUES (
                          SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                          1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                          TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '002', 0,
                          0, 1, 1, 1, 1, 1, 100, 'Y', 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0,
                          1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);

               ELSIF (sectype IN ('003','006')) THEN -- trai phieu, trai phieu chuyen doi
                   ---- INSERT SECURITIES_TICKSIZE (BUOC GIA)
                   INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
                   VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 1, 0, 10000000, 'Y');

                   ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                   INSERT INTO SECURITIES_INFO (
                          AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY,
                          LISTTINGDATE, REFERENCESTATUS, ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE,
                          OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE, AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE,
                          MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD, DAYRANGE, YEARRANGE, TRADELOT,
                          TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX, REPOLIMITMIN,
                          REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX,
                          SECURERATIOTMIN, SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX,
                          SECUREDRATIOMIN, SECUREDRATIOMAX, CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                   VALUES (
                          SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                          1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                          TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '002', 0,
                          0, 1, 1, 1, 1, 1, 1, 'Y', 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0,
                          1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);
               ELSE
                         ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
                   INSERT INTO SECURITIES_INFO (
                          AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY,
                          LISTTINGDATE, REFERENCESTATUS, ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE,
                          OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE, AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE,
                          MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD, DAYRANGE, YEARRANGE, TRADELOT,
                          TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX, REPOLIMITMIN,
                          REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX,
                          SECURERATIOTMIN, SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX,
                          SECUREDRATIOMIN, SECUREDRATIOMAX, CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                   VALUES (
                          SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                          1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                          TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '002', 0,
                          0, 1, 1, 1, 1, 1, 0, 'Y', 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0,
                          1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);


               END IF;

            ---- INSERT SECURITIES_RATE
             INSERT INTO SECURITIES_RATE (
                    AUTOID, CODEID, SYMBOL, FROMPRICE, TOPRICE, MRRATIORATE, MRRATIOLOAN, STATUS)
             VALUES (
                    v_AUTOIDSR, V_CODEID, V_SYMBOL, 1, 10000000, 100, 100, 'Y');

          ELSIF (V_TRADENAME IN ('BOND', 'TPRL')) THEN
             ---- INSERT SECURITIES_TICKSIZE (BUOC GIA)
             INSERT INTO SECURITIES_TICKSIZE (AUTOID, CODEID, SYMBOL, TICKSIZE, FROMPRICE, TOPRICE, STATUS)
             VALUES (SEQ_SECURITIES_TICKSIZE.NEXTVAL, V_CODEID, V_SYMBOL, 100, 100, 10000000, 'Y');

             ---- INSERT SECURITIES_INFO (TT CHI TIET MA CK)
             INSERT INTO SECURITIES_INFO (
                          AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY,
                          LISTTINGDATE, REFERENCESTATUS, ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE,
                          OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE, AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE,
                          MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD, DAYRANGE, YEARRANGE, TRADELOT,
                          TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX, REPOLIMITMIN,
                          REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX,
                          SECURERATIOTMIN, SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX,
                          SECUREDRATIOMIN, SECUREDRATIOMAX, CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
                   VALUES (
                          SEQ_SECURITIES_INFO.NEXTVAL, V_CODEID, V_SYMBOL, TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                          1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                          TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '002', 0,
                          0, 1, 1, 1, 1, 1, 1, 'Y', 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0,
                          1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);

                  ---- INSERT SECURITIES_RATE
             INSERT INTO SECURITIES_RATE (
                    AUTOID, CODEID, SYMBOL, FROMPRICE, TOPRICE, MRRATIORATE, MRRATIOLOAN, STATUS)
             VALUES (
                    v_AUTOIDSR, V_CODEID, V_SYMBOL, 1, 10000000, 99, 99, 'Y');



           END IF;


           -- insert th?m cho chung kho?n ch? jao d?ch

           /* SELECT TO_CHAR(lpad( MAX(ODR)+2,6,0)) into v_strWFTcodeid   FROM
                        (SELECT ROWNUM ODR, INVACCT
                        FROM (SELECT CODEID INVACCT FROM SBSECURITIES  ORDER BY CODEID) DAT
                        WHERE TO_NUMBER(INVACCT)=ROWNUM) INVTAB ;*/
    if v_SECTYPE <> '011' then --Ngay 06/03/2017 CW NamTv bo khong tao WFT
            SELECT TO_CHAR(lpad(MAX(TO_NUMBER(INVACCT)) + 2,6,0)) AUTOINV into v_strWFTcodeid  FROM
            (
                SELECT ROWNUM ODR, INVACCT
                FROM (SELECT CODEID INVACCT FROM SBSECURITIES WHERE SUBSTR(CODEID, 1, 1) <> 9 ORDER BY CODEID) DAT
            ) INVTAB;



            insert into sbsecurities(CODEID,ISSUERID,SYMBOL,SECTYPE,INVESTMENTTYPE,RISKTYPE,PARVALUE,FOREIGNRATE,STATUS,TRADEPLACE,DEPOSITORY,SECUREDRATIO,MORTAGERATIO,REPORATIO,ISSUEDATE,EXPDATE,INTPERIOD,INTRATE,HALT,SBTYPE,CAREBY,CHKRATE,REFCODEID,MANAGEMENTTYPE)
            VALUES( TO_CHAR( v_strWFTcodeid) ,  V_ISSUERID, V_SYMBOL||'_WFT' , v_SECTYPE, '', '', V_PARVALUE, V_FOREIGNRATE, V_STATUS,'006' ,'002' , 0, 0, 0, v_ISSUEDATE, V_EXPDATE, V_INTPERIOD, V_INTRATE, 'N', '001',V_CAREBY, v_CHKRATE,  V_CODEID, V_MANAGEMENTTYPE);


            INSERT INTO SECURITIES_INFO (
                    AUTOID, CODEID, SYMBOL, TXDATE, LISTINGQTTY, TRADEUNIT, LISTINGSTATUS, ADJUSTQTTY, LISTTINGDATE, REFERENCESTATUS,
                    ADJUSTRATE, REFERENCERATE, REFERENCEDATE, STATUS, BASICPRICE, OPENPRICE, PREVCLOSEPRICE, CURRPRICE, CLOSEPRICE,
                    AVGPRICE, CEILINGPRICE, FLOORPRICE, MTMPRICE, MTMPRICECD, INTERNALBIDPRICE, INTERNALASKPRICE, PE, EPS, DIVYEILD,
                    DAYRANGE, YEARRANGE, TRADELOT, TRADEBUYSELL, TELELIMITMIN, TELELIMITMAX, ONLINELIMITMIN, ONLINELIMITMAX,
                    REPOLIMITMIN, REPOLIMITMAX, ADVANCEDLIMITMIN, ADVANCEDLIMITMAX, MARGINLIMITMIN, MARGINLIMITMAX, SECURERATIOTMIN,
                    SECURERATIOMAX, DEPOFEEUNIT, DEPOFEELOT, MORTAGERATIOMIN, MORTAGERATIOMAX, SECUREDRATIOMIN, SECUREDRATIOMAX,
                    CURRENT_ROOM, BMINAMT, SMINAMT, MARGINPRICE)
             VALUES (
                    SEQ_SECURITIES_INFO.NEXTVAL, v_strWFTcodeid, V_SYMBOL||'_WFT', TO_DATE (v_strCURRDATE, systemnums.c_date_format),
                    1, 1000, 'N', 1, TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 1, 1,
                    TO_DATE (v_strCURRDATE, systemnums.c_date_format), '001', 0, 0, 0, 0, 0, 0, 1, 1, 0, '001',
                    0, 0, 1, 1, 1, 1, 1, 10, 'Y', 0, 1000000000, 0,
                    1000000000, 0, 1000000000, 0, 1000000000, 0, 1000000000, 0, 0, 1, 1, 0, 1000000000, 1, 102, 0, 0, 0, 0);
    end if;


EXCEPTION
   WHEN OTHERS
   THEN
      plog.error ('prc_update_ticksize: ' || SQLERRM || dbms_utility.format_error_backtrace);
      RETURN;
END;
/
